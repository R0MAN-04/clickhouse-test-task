# clickhouse-test-task
Тестове завдання на основі датасету:  https://www.kaggle.com/datasets/oles04/bundesliga-soccer-player

Переважний діалект SQL для вирішення задачі - ClickHouse

1) Вивести топ-3 клуби із найдорожчим захистом (Defender-*)
Запит:
SELECT 
    club
    ,SUM(price) AS total_defence_value
FROM bundesliga_player
WHERE position LIKE 'Defender -%'
GROUP BY club
ORDER BY total_defence_value DESC
LIMIT 3;
| club              | total\_defence\_value |
| ----------------- | --------------------- |
| Bayern Munich     | ...                   |
| Borussia Dortmund | ...                   |
| RB Leipzig        | ...                   |



3) У розрізі клубу та гравця порахувати, скільки гравців підписало контракт із клубом після нього



4) Вибрати клуби, де середня вартість французьких гравців більша за 5 млн
5) Вибрати клуби, де частка німців вища за 90%
6) Вибрати найдорожчого у своєму віці (на виході ім'я + вартість)
7) Вибрати гравців, з вартістю у 1.5 рази більше, ніж у середньому за своєю позицією
8) На якій позиції найважче отримати контракт з будь-якою компанією
9) Порахувати, в якій команді найперше закінчиться контракт у 5 гравців
10) У якому віці гравці здебільшого виходять на пік своєї вартості
11) У якої команди найзіграніший склад (найдовше грають разом)
12) У яких командах є тезки
13) Вивести команди, де топ-3 гравці займають 50% платіжної відомості
